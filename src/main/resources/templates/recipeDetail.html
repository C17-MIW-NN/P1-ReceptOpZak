<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/extras/spring-security">

<head th:replace="~{fragments/general :: baseheader(~{:: title})}">
    <title>Recept details</title>
</head>

<body>

<div th:replace="~{fragments/general :: navBar}"></div>

<div class="container mt-5">


    <h2 class="mb-3">Recept: <span th:text="${recipe.recipeName}">Receptnaam</span></h2>


    <div class="card h-100">
        <img th:src="${recipe.imageURL} ?: '/images/defaultRecipe.png'"
             class="card-img-top object-fit-cover rounded"
             style="height: 250px; object-fit: cover;"
             th:alt="|Image for ${recipe.recipeName}|">
    </div>

    <div class="mb-5">
        <h4>Categorieën</h4>
        <ul class="list-group list-group-flush">
            <li class="list-group-item" th:each="category : ${recipe.categories}"
                th:text="${category.categoryName}">Categorie</li>
        </ul>
    </div>


    <p class="text-muted" th:if="${recipe.recipeUser}">
        Toegevoegd door: <strong th:text="${recipe.recipeUser.userName}">Gebruiker</strong>
    </p>


    <div class="mb-4">
        <style>
            textarea.auto-expand {
                resize: none;
                overflow: hidden;
            }
        </style>
        <label class="form-label fw-bold">Beschrijving</label>
        <textarea class="form-control auto-expand" rows="2"
                  readonly th:text="${recipe.description}">Beschrijving van het recept</textarea>
    </div>


    <div class="mb-4">
        <label class="form-label fw-bold">Ingrediënten</label>
        <div class="border rounded p-3 bg-light">
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">Ingredient</th>
                    <th scope="col">Hoeveelheid</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="ingredientUse : ${recipe.getRecipeIngredients()}">
                    <td th:text="${ingredientUse.ingredient.ingredientName}"></td>
                    <td th:text="${ingredientUse.quantity}"></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="mb-4">
        <label class="form-label fw-bold">Bereidingswijze</label>
        <div th:each="instruction : ${recipe.instructions}">
            <p><strong>Stap [[${instruction.stepNumber}]]:</strong> [[${instruction.text}]]</p>
        </div>
    </div>


    <div class="mb-5">
        <a th:if="${#authentication.name == recipe.recipeUser.userName}"
           th:href="@{/recipe/edit/{recipeName}(recipeName=${recipe.recipeName})}"
           class="btn btn-warning me-2 rounded-5">Bewerk</a>

        <a th:if="${#authentication.name == recipe.recipeUser.userName}"
           th:href="@{/recipe/delete/{recipeId}(recipeId=${recipe.recipeId})}"
           class="btn btn-danger rounded-5"
           onclick="return confirm('Weet je zeker dat je dit recept wilt verwijderen?');">
            Verwijder
        </a>
    </div>


</div>

<div th:replace="~{fragments/general :: footer}"></div>
<div th:replace="~{fragments/general :: bottomScripts}"></div>

</body>
</html>
